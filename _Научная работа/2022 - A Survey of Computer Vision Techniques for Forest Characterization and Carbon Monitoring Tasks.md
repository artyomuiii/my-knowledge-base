*Svetlana Illarionova, ...*
**MDPI (Multidisciplinary Digital Publishing Institute)** - издатель научных журналов по многим дисциплинам, пропагандирует открытый доступ.

#### Словарь и сокращения:
#TODO
* **Greenhouse gas (GHG)** - парниковый газ
* **Remote sensing (RS)** - дистанционное зондирование Земли (ДЗЗ)
* **Unmanned aerial vehicle (UAV)** - БПЛА
* **Near-infrared (NIR)** - ближний инфракрасный диапазон
* **Short-wave infrared reflectance (SWIR)**
* **Normalised Difference Vegetation Index (NDVI)**
* **Vegetation Condition Index (VCI)**
* **Enhanced Vegetation Index (EVI)**
* **Atmospherically Resistant Vegetation Index (ARVI)**
* **Normalized Difference Red-edge (NDRE)**
* **Modified Simple Ratio (MSR)**
* **Chlorophyll Index (CI)**
* **Normalised Burn Ratio (NBR)**
* **Normalized Burn Ratio Thermal (NBRT)**
* **Burned Area Index (BAI)**
* **Soil Adjusted Vegetation Index (SAVI)**
* **Normalized Difference Water Index (NDWI)**
* **Normalized Difference Moisture Index (NDMI)**
* **Land Surface Water Index (LSWI)**
#### Abstract
Мой абстракт на русском:
1. Наблюдение за лесами (особенно в режиме реального времени) позволяет решать множество полезных задач: мониторинг и планирование лесных хозяйств и т.д. Дистанционное зондирование Земли во многом удовлетворяет эти потребности. Данные ДЗЗ включают разнообразные орбитальные наблюдения и наблюдения с БПЛА. По ним оцениваются структурное и функциональное разнообразия лесов, продуктивность, процессы деградации и их закономерности, обнаруживаются и анализируются обезлесения и пр.
2. Авторы своей целью ставят сделать обзор разных алгоритмов машинного обучения и разных данных ДЗЗ для последующего их понимания читателями и быстрого применения на практике.
3. Для этого авторами были проанализированы основные статьи по данной тематике за последние 10 лет, была изучена техническая литература, посвящённая датчикам основных спутников, снимающих Землю, и генерируемым ими данным и т.д.
4-5. Данная статья - одна из самых больших и объемлющих статей, существующих по данной тематике, позволит наиболее быстро познакомиться с новой темой или открыть для себя новые интересные статьи, идеи или целые направления.

Мой абстракт на английском:
1. Forest monitoring (especially in real time) allows you to solve many useful tasks: monitoring and planning of forestry, etc. Remote sensing of the Earth largely satisfies these needs. Remote sensing data includes a variety of orbital and UAV observations. According to them, the structural and functional diversity of forests, productivity, degradation processes and their patterns are assessed, deforestation is detected and analyzed, etc.
2. The authors aim to make an overview of different machine learning algorithms and different remote sensing data for subsequent understanding by readers and quick application in practice.
3. To do this, the authors analyzed the main articles on this topic over the past 10 years, studied the technical literature on sensors of the main satellites that take pictures of the Earth, and the data generated by them, etc.
4-5. This article is one of the largest and most comprehensive articles available on this topic, which will allow you to quickly get acquainted with a new topic or discover new interesting articles, ideas or whole directions.
#### 1. Introduction

Хотелось бы оценивать степень выбросов парниковых газов в атмосферу по понятным причинам. Леса явл-ся большим накопителем углерода => важно за ними наблюдать (желательно даже - в режиме реального времени) для мониторинга текущей ситуации, планирования и т.д. 

ДЗЗ во многом удовлетворяет потребности мониторинга лесов, планирования, управления и т.д. [[Данные ДЗЗ]] включают *орбитальные наблюдения* и *наблюдения с БПЛА*. Эти данные очень важны, однако их интеграция в гос. системы разных стран далеко не всегда поспевает за прогрессом в этой области.

*Что оценивается по данным ДЗЗ?*
Структурное и функциональное разнообразия лесов, оценка продуктивности, отслеживание процессов деградации и их закономерностей, обнаружение и анализ обезлесения и пр.

Для анализа данных ДЗЗ активно используются различные алгоритмы ML, и в частности, алгоритмы CV.

Данный обзор рассматривает разные алгоритмы ML и разные данные ДЗЗ для последующего их понимания читателями и максимально быстрого применения.
#### 2. Review Methodology
Интерес к оценке характеристик лесов постоянно растёт. Авторы собрали статистику за последние 10 лет по ДЗЗ с некоторыми перечисленными выше задачами, исключая не интересные им предметные области (медицина, социальные науки и т.д.), собрали данные по конкретным задачам. Также авторы проанализировали статистику по статьям, которые используют ML. Сравнили кол-во статей, использующих нейросетевые и классические методы ML. Изучили как часто применяют определённые [[Данные ДЗЗ|данные ДЗЗ]]. По результатам исследования предлагаются графики:

![[Pasted image 20231208181257.png]]
==Анализ литературы== был выполнен с помощью баз данных **Scopus** и **Google Scholar**. Анализировались статьи с 2017 по 2022 год. Исключение - более старые фундаментальные или пионерские в данной теме статьи с высоким цитированием. Статьи искались по ключевым словам тем, связанных с лесом, и тем, связанных с ML, отсортированые по уровню цитирования (нулевое цитирование тоже иногда рассматривалось, см. подробнее в статье). По большей части рассматривались статьи с >20 цитатами, с ключевыми словами в названии и аннотации, заключительной стадией публикации и на английском языке. Кроме исследовательских статьей были рассмотрены также некоторые обзорные статьи.

#### 3. Remote Sensing Data and Spectral Indices for Forest Analysis
###### 3.1. Sources of Remote Sensing Data
Обзоры, посвящённые описаниям распространенных платформ ДЗЗ и комбинаций датчиков, применяемых к задаче анализа растительности - \[12,13,28,29\].

*Характеристики источников данных ДЗЗ:* доступность данных, повторяемость съёмки, пространственное разрешение, тип датчика, технические характеристики датчика, диапазон спектральных каналов и т.д.

*Характеристики данных ДЗЗ:* пространственное, временное и спектральное разрешения.
Чаще всего смотрят на пространственное разрешение. Оно бывает:
* низкое - >30 m на пиксель;
* среднее - \[10, 30\] m;
* высокое - <5 m.


У каждого источника данных есть преимущества и ограничения, определяемые условиями обнаружения и соотношением между пространственным разрешением, временем повторного просмотра и стоимостью. Например, *радары* не зависят от погодных условий и не полагаются на солнце как на источник освещения и поэтому могут получать данные независимо от условий дня или ночи. Напротив, **пассивным мультиспектральным** и **гиперспектральным** датчикам требуется солнечное излучение. Кроме того, чем грубее изображение, полученное со спутника, тем чаще оно делается. Чтобы объединить частоту получения изображений с низким разрешением с более
подробной информацией о других доступных данных или восстановить информацию, которая была утеряна из-за неподходящих условий, были реализованы различные методы слияния, основанные на ML.

Кол-во доступных диапазонов на разных спутниках может варьироваться. Можно использовать все диапазоны, доступные на выбранном спутнике, выбрать или объединить (для получения спектральных индексов, см. ниже) некоторые из них. Частным случаем вспомогательного использования является **панхроматический канал**. Благодаря своей широкой полосе пропускания он пропускает больше света => он имеет более высокое пространственное разрешение. Разрешение спутниковых изображений можно регулировать с помощью методов повышения резкости.

[[Данные ДЗЗ#^6b8d44|Информация по источникам данных и самим данным ДЗЗ]]

Полезные ресурсы:
* Level-1
* Atmosphere Archive & Distribution System Distributed Active Archive Center (LAADS DAAC)
* инструменты и сервисы - https://ladsweb.modaps.eosdis.nasa.gov/tools-and-services/
* https://scihub.copernicus.eu
* https://www.planet.com/products/platform/
###### 3.2. Popular Spectral Indices Applied for Forest Monitoring Research
**Спектральные индексы** - математически преобразованные и объединённые полосы данных ДЗЗ.

Группа растительных индексов:
* **Normalized Difference Vegetation Index (NDVI)** - основан на ближнем инфракрасном **(near-infrared, NIR)** и красном диапазонах отражения. 
	![[Pasted image 20231212161629.png]]
	Имеет производные индексы, например:
   * **Vegetation Condition Index (VCI)** - основан на минимальном и максимальном значениях NDVI за данный период
	   ![[Pasted image 20231212161756.png]]
	   где $i$ - пиксель, $p$ - период, $j$ - год
* **Enhanced Vegetation Index (EVI)** - лучше работает при большой лиственной насыщенности, что в случае NDVI приводило к заниженной оценке - связано с отражением красного света зеленью растительности (подробнее см. в статье)
	   ![[Pasted image 20231212162157.png]]
* **Atmospherically Resistant Vegetation Index (ARVI)** - для изучения атмосферного воздействия
	![[Pasted image 20231212161856.png]]

В случае большой насыщенности можно также использовать индексы, основанные на **Red-edge** спектральной полосе, но данная полоса есть не во всех данных ДЗЗ (есть, например, в Sentinel-2, WorldView-2 и 3, RapidEye):
* **Normalized Difference Red-edge (NDRE)**
	![[Pasted image 20231212161705.png]]
* **Modified Simple Ratio (MSR) Red-edge index**
	![[Pasted image 20231212163625.png]]
* **Chlorophyll Index (CI) Red-edge**
	![[Pasted image 20231212163552.png]]

Важной темой также явл-ся обнаружение возникновения и распространения пожаров, смягчение их последствий. При решении этой задачи используются свои спектральные индексы, основанные на **Short-Wave Infrared Reflectance (SWIR)**:
* **Normalized Burn Ratio (NBR)**
	![[Pasted image 20231212164244.png]]
* **Normalized Burn Ratio Thermal (NBRT)**
	![[Pasted image 20231212164331.png]]
	где $TIR$ - тепловая полоса
* **Burned Area Index (BAI)** - для оценки тяжести пожара и определения площади горения
	![[Pasted image 20231212164539.png]]

Чтобы учесть характеристики окружающей среды и использовать её в качестве фона для наземных, водных или прибрежных лесных экосистем, дополнительно используются следующие индексы:
* **Soil Adjusted Vegetation Index (SAVI)** - позволяет корректировать яркость почвы
	![[Pasted image 20231212165024.png]]
	где $L$ - *почвенный коэффициент*, варьирующийся от 0 до 1, что соответствует густой растительности и отсутствию растительности соотв., в то время как 0.5 считается значением по умолчанию для большинства типов растительного покрова
* **Normalized Difference Water Index (NDWI) = Land Surface Water Index (LSWI) = Normalized Difference Moisture Index (NDMI)** - такие индексы также используются для отслеживания повреждений, отличных от пожаров, таких как, например, вспышки патогенов
	![[Pasted image 20231212165059.png]]

Использование спектральных индексов имеет определённые ограничения, которые следует принимать во внимание (атмосферный эффект; существенная разница при разных источниках данных; сезонная зависимость и т.д. => нужна тщательная предварительная обработка - подробнее см. в статье).
#### 4. Computer Vision Algorithms
Решается задача [[Семантическая сегментация|семантической сегментации]]. В данном разделе будут рассмотрены алгоритмы (обучение с учителем) классического ML и DL.
###### 4.1. Classical Machine Learning Algorithms
1. **Случайный лес (Random Forest, RF)** - ансамбль **деревьев решений (Decision Tree, DT)** + **метод случайных подпространств**.
   Ансамбль выполняется на нескольких деревьях, обученных на разных подвыборках данных, что помогает избежать проблем с переобучением, возникающих при использовании только одного дерева. Результирующий класс или значение прогнозируется путем усреднения по всем деревьям или выбора класса, который прогнозируется большинством деревьев. Но случайный лес гораздо сложнее интерпретировать, чем одно дерево решений.

   Основные обучаемые параметры:
   * кол-во деревьев, определяющих сложность алгоритма;
   * кол-во признаков для разделения выборки;
   * максимальная глубина деревьев, ответственная за переобучение и точность модели;
   * критерий, по которому будет оцениваться однородность (энтропия) каждого листа в дереве;
   * минимальное кол-во объектов, на которых выполняется разбиение, при уменьшении этого параметра качество обучения повышается, но и время обучения увеличивается, и вер-ть переобучения соотв.

   Одним из преимуществ RF является скорость работы.
   Алгоритм реализован, например, в библиотеке **Scikit-learn**.

2. **Метод опорных векторов (Support Vector Machine, SVM)**
Метод использует различные ядра (в том числе и нелинейные). Для задачи классификации определяется оптимальная гиперплоскость, которая обеспечивает наилучшее разделение классов.

   Основные обучаемые параметры:
   * тип ядра (например, одним из наиболее популярных типов ядра является **гауссово ядро (rbf)**);
   * гиперпараметры ядра;
   * ширина ядра.

   **Support Vector Regression (SVR)** - метод, основанный на SVM и применяющийся для задачи регрессии.

3. **k ближайших соседей (k-nearest neighbor, kNN)** - непараметрический алгоритм, который учитывает расстояния между элементами выборки. Алгоритм работает на следующем предположении: *наиболее похожие точки данных расположены ближе друг к другу*. Класс новой точки предсказывается, учитывая классы k (гиперпараметр) ближайших соседей из обучающей выборки, используя мажоритарное правило. Алгоритм может быть использован для регрессионной задачи - целевое значение нового объекта есть усреднённое целевое значение k его ближайших соседей (мб с весами).

4. **Градиентный бустинг (Gradient Boosting, GB)** - ансамблевый метод, модель строится последовательно с использованием более слабых обучаемых моделей. В качестве таковых чаще всего используются деревья. Идея - *каждый следующий элемент ансамбля пытается скорректировать ошибку совокупности предыдущих*.

   **XGBoost (eXtreme Gradient Boosting)** - одна из реализацией градиентного бустинга, поддерживающая мощную регуляризацию и параллелизм внутри каждого дерева, создавая новые ветви независимо.

Подходы для улучшения качества:
* **Метод главных компонент (Principal Components Analysis, PCA)** - метод уменьшения размерности, линейное преобразование без учителя. (Применение PCA к данным ДЗЗ - 67.)
* RF-алгоритм для отбора признаков для обучения, однако коррелированные признаки следует исключить заранее.
* Подбор оптимальных гиперпараметров. Для этого можно использовать следующие инструменты оптимизации: **Optuna** или **scikit-optimize** (включая байесовскую оптимизацию).
###### 4.2. Deep Learning Algorithms
Архитектуры CNN для сегментации:
1. **U-Net**
   ![[Pasted image 20231220182025.png]]
   * **downsample**-часть включает в себя несколько слоев свёртки. Обычно используется ядро размером 3, за которым следуют нелинейность **ReLU** и слой **Max-pooling**, понижающий размерность.
   * **upsample**-часть повышает размерность до исходных значений, используя промежуточные представления исходных данных, взятые из кодировщика с соответствующих шагов. В итоге получаем маску размера первоначальной картинки, где каждому пикселю выставлен определённый класс.
   * Обучается всё **методом обратного распространения ошибки (backpropagation)**. Параметры обновляются итеративно  на основе вычисленной ошибки - **функции потерь** (например, **кросс-энтропия**).
	![[Pasted image 20231220141836.png]]
	Где $N$ - кол-во пикселей, $C$ - кол-во классов, $\hat y$ - предсказанная вер-ть принадлежности пикселя к определенному классу, $y$ - истинная метка принадлежности пикселя к классу (0 или 1, соотв).
   * В случае дисбаланса классов имеется возможность настроить важность каждого класса с помощью **весовой функций**.

2. **Functional Pyramid Network (FPN)** \[72\]
   ![[Pasted image 20231220182057.png]]
   * Также состоит из двух связанных частей.
   * Одна из особенностей - одновременное использование различных семантических уровней и, соотв., разрешений (чем меньше семантики, тем выше разрешение и наоборот) => сразу работаем с обоями видами информации.
3. [[2017 - LinkNet|LinkNet]]
   ![[Pasted image 20231220182458.png]]
4. **PSPNet** \[76\]
   ![[Pasted image 20231220182516.png]]
5. **FCN** \[73\]
6. **DeepLab** \[74\]

Преимущество DL-подхода - учитывание пространственной информации исходного изображения.
Минусы - необходимо много размеченных данных + дольше обучать.

Параметры обучения NN:
* кол-во эпох;
* число шагов в каждой эпохе;
* размер батча (**batch**);
* размер изображений;
* шаг обучения (**learning rate**);
* оптимизатор (например, [[SGD]], [[Adam]], [[RMSProp]]);
* глубина NN;

Подход к обучению NN:
* момент остановки обучения определяется по выходу точности/качества на "плато" на валидационных данных в течении нескольких эпох;
* есть стратегии обучения ОЧЕНЬ больших сетей;
* использование регуляризаторов, например, **Dropout** - отбрасывает случайные нейроны при обучении, уменьшает ко-адаптацию между ними, на инференсе явно не используется (только кратная поправка на значение вер-ти отбрасывания), хотя есть исключения (например, **Monte Carlo dropout** \[82\])
#### 5. Evaluation Metrics
###### 5.1. Classification
* **True Positive (TP)**, **False Positive (FP)**, **True Negative (TN)**, **False Negative (FN)**;
* **Accuracy** - работает только в ситуации сбалансированных классов;
* **Precision**, **Recall**;
* **F1-score** - работает и в ситуации несбалансированных классов, среднее гармоническое значение, чем ближе к 1, тем лучше, считается для каждого класса отдельно(?);
* **IoU (Intersect over Union)** - коррелирует с F1-score, но IoU ближе к минимальному значению между Precision и Recall;
* **AUC (Area Under the Curve)** **ROC (Receiver Operating Characteristic)** - площадь под ROC-кривой. Использует **True positive rate (TPR)** и **False positive rate (FPR)**. Показывает способность модели корректно ранжировать прогнозы.
###### 5.2. Regression
* **mean absolute error (MAE)**;
* **mean square error (MSE)**;
* **root mean square error (RMSE)**;
* **mean absolute percentage error (MAPE)** - учитывает положение(?) таргета и предсказания;
* **mean bias error (MBE)** - позволяет понять тенденцию модели к занижению или завышению целевых значений, поскольку может быть как положительной, так и отрицательной, учитывает положение(?) таргета и предсказания;
* **коэффициент детерминации** ($R^2$) - показывает соотношение между дисперсией, объясняемой моделью, и дисперсией в данных.
#### 6. Forest Mask Estimation on Remote Sensing Data
*Задача:* на выходе построить бинарную маску, где 1 отвечает за присутствии леса в данном пикселе, 0 - в отсутствии, т.е. задача - выделить лесной массив. Это пример задачи бинарной семантической сегментации.
##### 6.1. Use of Data of Different Spatial Resolution
###### 6.1.1. Low Spatial Resolution
Рекомендуется для региональных и национальных оценок характеристик лесного покрова.

Источники данных:
* Terra MODIS;
* ALOS PALSAR.
###### 6.1.2. Medium Spatial Resolution
Используются для детальной сегментации лесной маски.

Источники данных:
* Sentinel;
* Landsat.

Эти данные используются для:
* распознавания незаконной вырубки лесов;
* извлечения вспомогательной информации (облака, тени от облаков, растительность, почвы/пустыни, вода, снег и т.д. - 20 m);
* общеевропейских **High-Resolution Layers (HRL)** (плотность древесного покрова, преобладающий тип деревьев и т.д. - 10 m).
###### 6.1.3. High Spatial Resolution
Данные полезны, когда требуется более подробная лесная маска, включающая разделение отдельных деревьев, небольших групп деревьев и небольших участков в лесу с лугами и дорожками.

Источники данных:
* WorldView;
* Spot;
* RapidEye;
* Planet.
###### 6.1.4. Use of Data from Unmanned Aerial Vehicle
Такие данные представляют самое высокое пространственное разрешение, но очень дорогие и долго снимаются.
##### 6.2. Computer Vision Algorithms for Forest Mask Estimation. Specifics and Limitations of the Approach
Индексы растительности - простейший подход к CV, но с низкой надёжностью, т.к. многое зависит от различных спутниковых данных, условий окружающей среды и сезонов.

Классические алгоритмы ML: лучшие результаты демонстрируют RF и SVM. kNN показывает более плохие результаты.

DL-подход, основанный на использовании CNN: U-Net с **inception** обходит FPN, хорошо себя показывает U-Net с **attention**, хорошие результаты демонстрирует **DeepLabV3+** + **Efficient-net-b7**.
В случае ограниченного кол-ва размеченных данных можно использовать **transfer learning** с последующим **fine-tuning**-ом параметров.
#### 7. Forest-Forming Species Classification on Remote Sensing Data
*Задача:* многоклассовая семантическая сегментация, где каждому пикселю ставится в соответствие класс - порода/класс/вид дерева (например, ель, сосна, дуб и т.д.).

Наиболее часто для оценки качества используется F1-score.
##### 7.1. Use of Data of Different Spatial Resolution
Использование данных с различным разрешением определяется проблемой, которую необходимо решить с помощью знания состава древесных пород в интересующей области.
###### 7.1.1. Low Spatial Resolution
#STOP

Источники данных:
* Terra MODIS.
###### 7.1.2. Medium Spatial Resolution
###### 7.1.3. High Spatial Resolution
###### 7.1.4. Use of Data from Unmanned Aerial Vehicle
##### 7.2. Computer Vision Algorithms for Classifying Forest-Forming Species Types. Specifics and Limitations of the Approach
#### 8. Forest Resources Estimation on Remote Sensing Data
*Задача:* 
###### 8.1. Use of Data of Different Spatial Resolution
8.1.1. Low Spatial Resolution
8.1.2. Medium Spatial Resolution
8.1.3. High Spatial Resolution
8.1.4. Use of Data from Unmanned Aerial Vehicle
###### 8.2. Computer Vision Algorithms for the Task of Forest Resources Estimation. Specifics and Limitations of the Approach
#### 9. Discussion
###### 9.1. Forest Carbon Disturbing Events
###### 9.2. Data and Labeling Limitations
###### 9.3. Visual Transformers as State-of-the-Art CV Algorithms Relevant for Forest Taxation Problem
#### 10. Conclusions
#### References
12, 13, 28, 29, 67, 72, 73, 74, 76, 