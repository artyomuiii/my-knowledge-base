*Svetlana Illarionova, ...*

#TODO Где данная статья опубликовалась? Какой это уровень журнала?

#### ABSTRACT
Мой абстракт на русском:
1. Сегодня нейронные сети активно используются во многих разделах компьютерного зрения (CV). В частности, решая очень важную задачу дистанционного зондирования Земли (ДЗЗ), которая помогает определять наличие заболеваний лесных массивов, лесных пожаров, выявлять доминирующие виды, среднюю высоту, возраст и т.д.
2. Авторы статьи, решая задачу определения доминирующего вида (задачу семантической сегментации), ставят своей целью улучшение существующих методов семантической сегментации, а также создание размеченного датасета для общего пользования.
3. Улучшение достигается путём замены задачи многоклассовой сегментации на иерархический набор задач бинарной сегментации, а также путём использования дополнительной информации о высоте деревьев.
4. В результате повышается качество сегментации на разных используемых в обучении датасетах. Также авторами статьи сформирован размеченный датасет по части Ленинградской области.
5. В будущем можно использовать больше дополнительных данных о лесах в процессе обучения, а также продолжить создание точного размеченного датасета.

Мой абстракт на английском:
1. Today neural networks are actively used in many sections of computer vision (CV). In particular, solving is a very important task of remote sensing of the Earth (remote sensing), which helps to determine the presence of diseases of forests, forest fires, identify dominant species, average height, age of trees, etc.
2. The authors of the article who solve the problem of determining the dominant type (the problem of semantic segmentation), aim to improve existing methods of semantic segmentation, as well as to create a marked-up dataset for general use.
3. Improvement is achieved by replacing the multiclass segmentation task with a hierarchical set of binary segmentation tasks, as well as by using additional information about the height of trees.
4. As a result, the quality of segmentation on different datasets used in training increases. Also, the authors of the article have formed a marked-up dataset for the Leningrad region.

[[Дистанционное зондирование Земли]]
#### I. INTRODUCTION
Мультиспектральные спутниковые снимки среднего разрешения (*Landsat* или *Sentinel*) - в свободном доступе.
(???Мультиспектр и гиперспектр. Что это?)

Используется **LIDAR** - прибор, лазерный локатор. Работает аналогично радиолокатору, но более точный и с большей разрешающей способностью.

"???Спутниковые снимки с очень высоким пространственным разрешением, такие как
спутниковые данные WorldView (2 m)."

???QuickBird images (2.44 m)

Цели:
1. Улучшить многоклассовую сегментацию изображений лесных видов
путем разделения многоклассовой задачи на иерархию задач бинарной сегментации.
2. Использование карт высоты лесов в качестве доп. данных.
3. Создание размеченного датасета.

Были использованы и сравнены 6 архитектур NN. Для каждой задачи классификации имеется возможность найти лучшую архитектуру. Также протестировано на датасете *Sentinel*.
#### II. DATASET
###### A. Study Area
Ленинградская область
S ~ 20 тыс. га

Размеры кадрирования
WorldView: $256 * 256$ pxls
*Sentinel:* $64 * 64$ pxls

###### B. Reference Data
Исследуемая территория была разделена на небольшие регионы (далее - элементарные), описывающиеся:
* составом леса (по нему определяется доминирующий вид - самый представленный) - были исключены регионы со смешанными лесами, когда два и более видов деревьев одинакого наиболее представлены. Всего 4 вида - ели *(spruce)*, осины *(aspen)*, берёзы *(birch)* и сосны *(pine)*. Остальные виды деревьев представлены в меньших объёмах;
* средней высотой деревьев;
* средним возрастом деревьев.

P.S. Виды деревьев - не с биологической точки зрения, а с точки зрения качества древисины. Т.о., не делаются внутриродовые различия внутри одного рода.

![[Pasted image 20231026145558.png]]
![[Pasted image 20231026145900.png]]

###### C. Satellite Data
Все снимки в период высокой вегитации - с мая по август.

???  "WorldView 2 and 3 multispectral imagery with eight spectral
bands was downloaded from GBDX [31]. The spatial resolution
was about 2 m per pixel. Sentinel imagery with 13 spectral
bands and a spatial resolution of about 10 m per pixel was
downloaded from SentinelHub [32]. All images were from the
high vegetation period from May to August. Image acquisition
dates and catalogue IDs are presented in Tables II and III.
Dataset consists of georeferenced satellite images in the for-
mat of 8-b TIFF files and forestry inventory data converted into
raster per pixel masks for each class."

Специальная NN, сегментирующая лес, обрезает безлесые участки из обучающих и валидационных данных, ибо имеет место несоответствие во времени (какие-то леса уже вырублены физически, а информация о них в данных есть). Тестовый датасет почищен от этого вручную.

#### III. METHODS
###### A. Problem Definition

Решается задача сегментации - присвоить каждому пикселю определённый класс.

*Доп. проблемы:* данные могут быть противоречивыми - в пределах элементарных регионов могут быть видимые вкрапления недоминирующего вида деревьев.
###### B. Neural Networks for Image Segmentation
___
* **FCNN (Fully Connected NN)** - **U-Net**
* **FPN (Feature Pyramid Network)** - больше подходит для многоклассовой сегментации *(архитектуры выше работают по принципу кодер-декодер со skip connections => на самом деле можем использовать произвольный кодировщик)*
___
* **ResNet** (-34)
* **Inception-ResNet-v2** (-34)
* **EfficientNet** (B3)
___
Итого: $2 \cdot 3 = 6$ разных NN.

Реализация архитектур основана на:
*P. Yakubovskiy, “Segmentation models,” 2019. [Online]. Available: https://github.com/qubvel/segmentation_models*
###### C. Image Preprocessing

В *Sentinel* изначально значения в [0, 255] => [0, 1] - простая нормализация:
![[Pasted image 20231026154522.png]]
В *WorldView* кроме нормализации добавили повышение контрастности, которое подавляет самые тёмные и самые светлые участки (за тремя сигмами которые):
![[Pasted image 20231026154533.png]]
Использование (2)-(4) показывает лучший результат, чем простое масштабирование без использования статистик датасета.

`mean` и `std` можно считать сразу по всем каналам или для каждого канала отдельно. У каждого способа есть свои + и -.
###### D. Dataset Augmentation
С вер-тью 50%:
* поворот на 90°;
* горизонтальное или вертикальное отражение;
* увеличение или уменьшение масштаба в пределах 20%.
###### E. Oversampling

Для борьбы с дисбалансом классов были добавлены доп. веса для меньших классов при подсчёте ф-ции потерь (кросс-энтропия, **CE**).

Ещё одна проблема: нам не хочется обучаться на элементарных участках, в которых недоминирующие виды занимают около половины места - т.н. "грязная" разметка. Хочется обучаться на данных, которые обширно представлены (90%, например).

Анализ порогов:
![[Pasted image 20231031101237.png]] ^6e36b1
###### F. Problem Decomposition

Базовый подход (раньше, в других статьях) - выходной слой имел размерность, равную кол-ву классов (многоклассовая же сегментация). Метка класса для пикселя - просто $\arg \max$ этих значений.

Модификация подхода основана на том, что классификация лесных пород имеет четкую иерархию: классы делятся на хвойные *(coniferous)* и лиственные *(deciduous)* породы деревьев.

![[Pasted image 20231031110003.png]]
#TODO разобраться что тут вообще происхдит
![[Pasted image 20231031110124.png]]
Также было произведено сравнение с методом "one VS all".
###### G. Height Data
Средняя высота и средний возраст деревьев представляют собой важные данные, которые повышают качество и в случае рассмотрения задачи как многоклассовой, и в случае бинарной сегментаций.
![[Pasted image 20231031111632.png]]
#### IV. EXPERIMENTS
###### A. Training
* Всё обучение на PC с **GTX-1080Ti**.
* Батч: от 16 до 30.
* Ф-ция потерь вычисляетя только на части изображения, отвечающей родительскому классу (по родительской маске, напр. только там, где есть лес, далее там, где лес хвойный и тд???) в иерархическом подходе.
* Общие потери для батча нормализованы до области родительского класса:
![[Pasted image 20231031112313.png]]
Где: $w$, $h$ - размеры изображения, $b$ - размер батча, $N$ - кол-во пикселей в батче.
###### B. Medium Resolution Data
Те же эксперименты были проведены на данных *Sentinel-2* (бесплатные данные). Обучение такое же, как и для данных *WorldView*. Был изменён размер кадрирования, чтобы привести к одинаковому размеру, и чтобы процедура обучения была максимально похожа.
###### C. Evaluation
* Разделение на `train/valid/test`: 0.7/0.15/0.15
* На `valid` выбраны лучшие параметры и архитектура.
* $F_1$ используется для измерения качества сегментации:
![[Pasted image 20231031113519.png]]
* Также используется confusion matrix.
![[Pasted image 20231102132813.png]]

#### V. RESULTS AND DISCUSSION
###### A. Hierarchical Decomposition
![[Pasted image 20231031114555.png]]
![[Pasted image 20231031114616.png]]
![[Pasted image 20231031114800.png]]
![[Pasted image 20231031115247.png]]
TODO Многоклассовая сегментация VS "one vs all" - чем отличается?
![[Pasted image 20231031115348.png]]
![[Pasted image 20231031115355.png]]
![[Pasted image 20231031115647.png]]
![[Pasted image 20231031115654.png]]
TODO Много ошибок в тексте, поясняющем данные таблицы!!! Плавающая точность измерений (где-то 2 знака, а где-то 3).

*Плюсы* иерархического подхода: для каждой задачи классификации
может быть выбрана наиболее подходящая архитектура NN. Но данный подход применим, только когда установлена иерархия классов с семантической связью между ними внутри. Также это помогает снизить вычислительные затраты в случае большого числа классов ($\log N$, а не $N$).

*Минусы*: увеличивается кол-во используемых моделей, тратится больше памяти.
###### B. Supplementary Height Data
*Вердикт:* доп. данные о высоте реально помогают.

Ниже приведены примеры работы иерархической сегментации. На лицо хорошая работа.
![[Pasted image 20231031124549.png]]
![[Pasted image 20231031124616.png]]
###### C. Architecture Selection
Лучшие архитектуры:
Для *WorldView* - **Unet** + **Resnet34** / **FPN** + **Resnet34**
Для *Sentinel* - **FPN** + **Inception-Resnet-v2**
###### D. Augmentation and Oversampling
Т.к. аугментация данных хорошо изучена, в данной статье это исследование производилось только на одном из случаев. Действительно, аугментация помогает в обучении.

[[2021 - Neural-Based Hierarchical Approach for Detailed Dominant Forest Species Classification by Multispectral Satellite Imagery#^6e36b1|Таблица 4 с пороговыми значениями]]\
Сравнение двух стратегий: содержание доминирующих пород >50% VS для каждого класса выбран свой порог (0.7 для сосны и ели, 0.6 для берёзы и 0.5 для осины). Ниже - многоклассовая сегментация без данных о росте.
Видим, что качество при таком подходе увеличивается.
![[Pasted image 20231031130442.png]]
#### VI. CONCLUSION
Что сделали авторы статьи:
1. Размеченный датасет для определения доминирующих видов по части Ленинградской области.
2. Представлен иерархический подход к сегментации, который превосходит существующие методы. Данное преимущество продемонстрировано на датасетах *Sentinel* и *WorldView*.
3. Применено и исследовано влияние доп. данных о высоте, которые повышают качество итоговой модели.

На будущее:
1. Улучшение разметки данных.
2. Случаи смешанных лесов.
3. Исследование других характеристик лесов по спутниковым снимкам.
#### REFERENCES
