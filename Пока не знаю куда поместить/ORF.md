## Orthogonal Random Features
**Orthogonal Random Features (ORF)** - метод аппроксимации ядер.

**Идея:** Будем аппроксимировать с использованием [[Ортогональная матрица|ортогональной матрицы]] гауссово ядро вида:
$$
K(\mathbf{x}, \mathbf{y})=e^{-\|\mathbf{x}-\mathbf{y}\|^{2} / 2 \sigma^{2}}
$$

Матрица линейного преобразования [[RRF]] может быть записана в виде:
$$
\mathbf{W}_{\mathrm{RFF}}=\frac{1}{\sigma} \mathbf{G}
$$
Где $\mathbf{G} \in \mathbb{R}^{d \times d}$ - случайная гауссова матрица, каждая строка которой независимо сэмплируется из стандартного нормального распределения. Нормы строк матрицы из $\chi^2_d$-распределения.

Матрица линейного преобразования ORF имеет
следующий вид:
$$
\mathbf{W}_{\mathrm{ORF}}=\frac{1}{\sigma} \mathbf{S Q}
$$
Где $\mathbf{Q}$ - случайная [[Ортогональная матрица|ортогональная матрица]], $\mathbf{S}$ - диагональная матрица с диагональными независимыми элементами, взятыми из $\chi^2_d$-распределения ([[Хи-квадрат распределение|хи-квадрат]]), $\sigma$ -  среднее расстояние до 50го ближайшего соседа (эмпирический факт). 
*Алгоритм*: Сначала генерируем случайную гауссову матрицу $\mathbf{G}$. $\mathbf{Q}$ - ортогональная матрица, полученная из [[QR-разложение|QR-разложения]] $\mathbf{G}$. 

$K_{\mathrm{ORF}}(\mathbf{x}, \mathbf{y})$ и $K_{\mathrm{RFF}}(\mathbf{x}, \mathbf{y})$ - соответствующие аппроксимации ядра $K(\mathbf{x}, \mathbf{y})$ (несмещённые оценки). И $K_{\mathrm{ORF}}(\mathbf{x}, \mathbf{y})$ имеет меньшую дисперсию, чем $K_{\mathrm{RFF}}(\mathbf{x}, \mathbf{y})$ (есть соотв. теорема). И чем $z=\|\mathbf{x}-\mathbf{y}\| / \sigma$ ближе к $0$, тем меньше:
$$
\frac{\operatorname{Var}\left(K_{\mathrm{ORF}}(\mathbf{x}, \mathbf{y})\right)}{\operatorname{Var}\left(K_{\mathrm{RFF}}(\mathbf{x}, \mathbf{y})\right)}
$$
(с максимальной скоростью убывания $z^2$).

![[Pasted image 20220228221915.png]]

**Улучшения:** 
* [[SORF]];
* [[PCA]].